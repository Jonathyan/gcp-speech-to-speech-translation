âº Ik ga eerst de relevante bestanden bekijken om een accuraat diagram te
  maken:

âº Read(frontend/src/app.js)
  â¿  Read 71 lines (ctrl+r to expand)

âº Read(frontend/src/connection.js)
  â¿  Read 655 lines (ctrl+r to expand)

âº Nu ga ik een gedetailleerd ASCII architectuur diagram maken van hoe
  app.js en connection.js samenwerken:

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                    FRONTEND ARCHITECTUUR: APP.JS â†” CONNECTION.JS.                       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                                                                         â”‚
  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
  â”‚ â”‚                                   APP.JS                                            â”‚ â”‚
  â”‚ â”‚                            (Main Entry Point)                                       â”‚ â”‚
  â”‚ â”‚                                                                                     â”‚ â”‚
  â”‚ â”‚  ğŸš€ APPLICATIE OPSTARTEN                                                            â”‚ â”‚
  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚ â”‚
  â”‚ â”‚  â”‚ DOMContentLoaded    â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
  â”‚ â”‚  â”‚ Event Listener      â”‚                                                         â”‚  â”‚ â”‚
  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                         â”‚  â”‚ â”‚
  â”‚ â”‚            â”‚                                                                     â”‚  â”‚ â”‚
  â”‚ â”‚            â–¼                                                                     â”‚  â”‚ â”‚
  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”‚
  â”‚ â”‚  â”‚ Browser             â”‚    â”‚ UI Initialisatie    â”‚    â”‚ Global  Functions    â”‚  â”‚  â”‚ â”‚
  â”‚ â”‚  â”‚ Compatibility       â”‚    â”‚ window.AppUI        â”‚    â”‚ Export voor  Tests   â”‚  â”‚  â”‚ â”‚
  â”‚ â”‚  â”‚ Check               â”‚    â”‚ .initializeUI()     â”‚    â”‚                      â”‚  â”‚  â”‚ â”‚
  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ â”‚
  â”‚ â”‚                                                                                  â”‚  â”‚ â”‚
  â”‚ â”‚                                     â–¼                                            â”‚  â”‚ â”‚
  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”‚
  â”‚ â”‚  â”‚                          KNOP ENABLEMENT                                    â”‚ â”‚  â”‚ â”‚
  â”‚ â”‚  â”‚  â€¢ start-broadcast button â†’  window.AppConnection.connectWebSocket()        â”‚ â”‚  â”‚ â”‚
  â”‚ â”‚  â”‚  â€¢ join-listener button   â†’  window.AppConnection.connectWebSocket()        â”‚ â”‚  â”‚ â”‚
  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â”‚
  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
  â”‚                                            â”‚                                           â”‚
  â”‚                                            â–¼                                           â”‚
  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
  â”‚ â”‚                                CONNECTION.JS                                       â”‚ â”‚
  â”‚ â”‚                           (WebSocket Management)                                   â”‚ â”‚
  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
  â”‚ â”‚                                                                                    â”‚ â”‚
  â”‚ â”‚  ğŸ“¡ WEBSOCKET VERBINDING MANAGEMENT                                                â”‚ â”‚
  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                           â”‚ â”‚
  â”‚ â”‚  â”‚ connectWebSocket()  â”‚                                                           â”‚ â”‚
  â”‚ â”‚  â”‚ (url, mode,         â”‚                                                           â”‚ â”‚
  â”‚ â”‚  â”‚  streamId)          â”‚                                                           â”‚ â”‚
  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                           â”‚ â”‚
  â”‚ â”‚            â”‚                                                                       â”‚ â”‚
  â”‚ â”‚            â–¼                                                                       â”‚ â”‚
  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
  â”‚ â”‚  â”‚                      MODE BEPALING                                          â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚                                                                             â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚  mode === 'broadcast'  â†’ /ws/speak/{streamId}                               â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚  mode === 'streaming'  â†’ /ws/stream/{streamId}  â­ REALTIME VERTALING       â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚  mode === 'listener'   â†’ /ws/listen/{streamId}                              â”‚   â”‚ â”‚
  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
  â”‚ â”‚                                     â”‚                                              â”‚ â”‚
  â”‚ â”‚                                     â–¼                                              â”‚ â”‚
  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
  â”‚ â”‚  â”‚                     WEBSOCKET LIFECYCLE                                     â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚                                                                             â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚  onopen   â”€â”€â–º retryCount = 0                                                â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚           â”€â”€â–º handleConnectionSuccess(mode)                                 â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚           â”€â”€â–º window.AppUI.updateStatus("Verbonden...")                     â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚                                                                             â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚  onclose  â”€â”€â–º handleCleanDisconnect() OR                                    â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚           â”€â”€â–º handleConnectionError(url, mode, streamId)                    â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚                                                                             â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚  onerror  â”€â”€â–º handleConnectionError() met retry logica                      â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚                                                                             â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚  onmessage â”€â”€â–º handleIncomingMessage() OF                                   â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚            â”€â”€â–º handleIncomingAudioData()                                    â”‚   â”‚ â”‚
  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
  â”‚ â”‚                                     â”‚                                              â”‚ â”‚
  â”‚ â”‚                                     â–¼                                              â”‚ â”‚
  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
  â”‚ â”‚  â”‚                    MESSAGE VERWERKING                                       â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚                                                                             â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚  ğŸ“¨ TEXT BERICHTEN:                                                         â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â€¢ JSON Control Messages                                                 â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚       - type: 'keepalive' â†’ handleKeepalivePing()                           â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚       - type: 'audio_start' â†’ handleAudioStreamStart()                      â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚       - type: 'audio_end' â†’ handleAudioStreamEnd()                          â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚       - type: 'error' â†’ console.error()                                     â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚                                                                             â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚  ğŸ”Š AUDIO DATA:                                                             â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â€¢ ArrayBuffer/Blob â†’ processAudioData()                                 â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â€¢ MP3 playback via HTML5 Audio API                                      â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â€¢ Test markers â†’ playTestBeep()                                         â”‚   â”‚ â”‚
  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
  â”‚ â”‚                                     â”‚                                              â”‚ â”‚
  â”‚ â”‚                                     â–¼                                              â”‚ â”‚
  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
  â”‚ â”‚  â”‚                     AUDIO VERWERKING                                        â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚                                                                             â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚  ğŸ§ initializeAudioPlayer()                                                 â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â”‚                                                                       â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â–¼                                                                       â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚  processAudioData(audioData)                                                â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â”‚                                                                       â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â”œâ”€â–º ArrayBuffer/Blob Check                                              â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â”œâ”€â–º Test Marker Detection                                               â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â”œâ”€â–º MP3 Blob Creation                                                   â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â””â”€â–º HTML5 Audio Playback                                                â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚                                                                             â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚  ğŸ“Š AUDIO STATISTIEKEN:                                                     â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â€¢ chunksReceived, bytesReceived                                         â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â€¢ chunksProcessed, processingErrors                                     â”‚   â”‚ â”‚
  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
  â”‚ â”‚                                     â”‚                                              â”‚ â”‚
  â”‚ â”‚                                     â–¼                                              â”‚ â”‚
  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
  â”‚ â”‚  â”‚                     RETRY LOGICA                                            â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚                                                                             â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚  handleConnectionError():                                                   â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â”‚                                                                       â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â”œâ”€â–º retryCount < maxRetries?                                            â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â”‚   â””â”€â–º JA: exponential backoff delay                                   â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â”‚       â””â”€â–º setTimeout(() => connectWebSocket())                        â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â”‚                                                                       â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚     â””â”€â–º NEE: geef op en toon error                                          â”‚   â”‚ â”‚
  â”‚ â”‚  â”‚          â””â”€â–º window.AppUI.updateStatus("Verbinding mislukt...")             â”‚   â”‚ â”‚
  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
  â”‚                                            â”‚                                           â”‚
  â”‚                                            â–¼                                           â”‚
  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
  â”‚ â”‚                             UI INTEGRATIE                                          â”‚ â”‚
  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
  â”‚ â”‚                                                                                    â”‚ â”‚
  â”‚ â”‚  ğŸ“± UI STATUS UPDATES:                                                             â”‚ â”‚
  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ â”‚
  â”‚ â”‚  â”‚ connection.js      â”‚â”€â”€â”€â”€â–¶â”‚   window.AppUI     â”‚â”€â”€â”€â”€â–¶â”‚    DOM Elements     â”‚     â”‚ â”‚
  â”‚ â”‚  â”‚                    â”‚     â”‚                    â”‚     â”‚                     â”‚     â”‚ â”‚
  â”‚ â”‚  â”‚ â€¢ updateStatus()   â”‚     â”‚ â€¢ updateStatus()   â”‚     â”‚ â€¢ Status text       â”‚     â”‚ â”‚
  â”‚ â”‚  â”‚ â€¢ enableButtons()  â”‚     â”‚ â€¢ enableButtons()  â”‚     â”‚ â€¢ Button states     â”‚     â”‚ â”‚
  â”‚ â”‚  â”‚ â€¢ showError()      â”‚     â”‚ â€¢ showError()      â”‚     â”‚ â€¢ Error messages    â”‚     â”‚ â”‚
  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â”‚
  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
  â”‚                                                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              DATA FLOW DIAGRAM                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚  ğŸ‘¤ GEBRUIKER ACTIE                                                                      â”‚
â”‚       â”‚                                                                                  â”‚
â”‚       â–¼                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    DOM Event   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Global Call     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Button Click â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚    app.js       â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ connection.jsâ”‚ â”‚
â”‚  â”‚              â”‚                â”‚                 â”‚                    â”‚              â”‚ â”‚
â”‚  â”‚ â€¢ Broadcast  â”‚                â”‚ â€¢ Compatibility â”‚                    â”‚ â€¢ WebSocket  â”‚ â”‚
â”‚  â”‚ â€¢ Listen     â”‚                â”‚ â€¢ UI Init       â”‚                    â”‚ â€¢ Retry      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚ â€¢ Export Globalsâ”‚                    â”‚ â€¢ Audio      â”‚ â”‚
â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                          â”‚                                      â”‚        â”‚
â”‚                                          â–¼                                      â–¼        â”‚
â”‚                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                                 â”‚  window.AppUI   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  WebSocket   â”‚   â”‚
â”‚                                 â”‚                 â”‚    Status Updates â”‚  Messages    â”‚   â”‚
â”‚                                 â”‚ â€¢ Status Text   â”‚                   â”‚              â”‚   â”‚
â”‚                                 â”‚ â€¢ Button States â”‚                   â”‚ â€¢ Control    â”‚   â”‚
â”‚                                 â”‚ â€¢ Error Display â”‚                   â”‚ â€¢ Audio Data â”‚   â”‚
â”‚                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚ â€¢ Keepalive  â”‚   â”‚
â”‚                                          â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                          â–¼                                     â”‚         â”‚
â”‚                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â–¼         â”‚
â”‚                                 â”‚   DOM Update    â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                                 â”‚                 â”‚                   â”‚ Audio Player â”‚   â”‚
â”‚                                 â”‚ â€¢ Visual Status â”‚                   â”‚              â”‚   â”‚
â”‚                                 â”‚ â€¢ User Feedback â”‚                   â”‚ â€¢ MP3 Play   â”‚   â”‚
â”‚                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚ â€¢ Test Beeps â”‚   â”‚
â”‚                                                                       â”‚ â€¢ Statistics â”‚   â”‚
â”‚                                                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           BELANGRIJKE INTERACTIES                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚  ğŸ”„ APP.JS â†’ CONNECTION.JS:                                                              â”‚
â”‚     â€¢ window.AppConnection.connectWebSocket(url, mode, streamId)                         â”‚
â”‚     â€¢ window.AppConnection.disconnectWebSocket()                                         â”‚
â”‚     â€¢ window.AppConnection.sendAudioChunk(websocket, audioData)                          â”‚
â”‚                                                                                          â”‚
â”‚  ğŸ”™ CONNECTION.JS â†’ UI (via window.AppUI):                                               â”‚
â”‚     â€¢ window.AppUI.updateStatus(message)                                                 â”‚
â”‚     â€¢ window.AppUI.enableButtons(enabled)                                                â”‚
â”‚     â€¢ window.AppUI.showError(title, message, options)                                    â”‚
â”‚                                                                                          â”‚
â”‚  ğŸ“Š STAAT BEHEER:                                                                        â”‚
â”‚     â€¢ currentWebSocket (global in connection.js)                                         â”‚
â”‚     â€¢ retryCount (connection retry logic)                                                â”‚
â”‚     â€¢ audioStats (audio processing statistics)                                           â”‚
â”‚     â€¢ userHasInteracted (autoplay policy compliance)                                     â”‚
â”‚                                                                                          â”‚
â”‚  ğŸ¯ FOUTAFHANDELING:                                                                     â”‚
â”‚     â€¢ Exponential backoff retry (2^retryCount * base delay)                              â”‚
â”‚     â€¢ Clean disconnect vs error disconnect                                               â”‚
â”‚     â€¢ Audio playback fallbacks (beep sounds)                                             â”‚
â”‚     â€¢ Browser autoplay policy handling                                                   â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

## Samenvatting van de Samenwerking

### ğŸš€ App.js Rol:
- **Entry Point**: Initialiseert de hele applicatie
- **Browser Compatibility**: Controleert of alles werkt
- **UI Setup**: Roept `window.AppUI.initializeUI()` aan
- **Global Exports**: Maakt functies beschikbaar voor tests
- **Event Binding**: Verbindt knoppen aan WebSocket functies

### ğŸ“¡ Connection.js Rol:
- **WebSocket Beheer**: Volledige verbindingslogica
- **Mode Routing**: Verschillende endpoints per functie
- **Audio Processing**: Speelt ontvangen MP3 af
- **Retry Logic**: Automatisch opnieuw proberen bij fouten
- **Keepalive**: Houdt verbinding levend met ping/pong

### ğŸ”— Hoe Ze Samenwerken:
1. **App.js** initialiseert en maakt `window.AppConnection` functies beschikbaar
2. **Gebruiker klikt** op een knop â†’ roept `connectWebSocket()` aan
3. **Connection.js** maakt WebSocket verbinding en handelt alle berichten af
4. **Status updates** gaan via `window.AppUI` terug naar de gebruiker
5. **Audio data** wordt direct afgespeeld via HTML5 Audio API

De architectuur is **modulair** en **robuust** met duidelijke scheiding tussen initialisatie (app.js) en verbindingsbeheer (connection.js).


